使用须知 user guide
本使用须知是为我的同事们写的，包含实际使用过程中可能遇到的问题（原文件是个pdf）：因为无法上传新华传媒的数字资产，所以我只上传了文字内容；部分内容只有使用过新华传媒p2p平台的人才能知道我在说什么，你们可以无视。字太多我懒得翻译，非中文使用者要看就用谷歌翻译吧。
This instruction is written for my colleagues, including the actual use and the problems that may encounter. The original file is a pdf: because of the inability to upload the digital assets of Xinhua Media, I only uploaded the text content; part of the content only can people used the p2p platform can know what I'm talking about, you can ignore it. It's frustrating to translate them so I didn't, non-Chinese speakers may use Google Translate if you really want to read it.

使用前须知
1：本脚本基于图像识别后模拟鼠标点击相对位置进行（也因此必须登陆p2p平台后再使用），因此请将分辨率调整至1920x1440使用；为了提升识别正确率，可以将p2p平台的网页移动至新窗口（操作方法：鼠标拖拽页面标签离开标签栏即可将其与其他页面分开到不同窗口哦），以免程序与“购物车”等页面混淆。


2：请将该软件置于全英文路径下运行！
请将该软件置于全英文路径下运行！
请将该软件置于全英文路径下运行！

3：软件出现报错或进程结束后会直接关闭窗口，无法查看运行记录和报错（打包程序底层代码导致）。若希望保留窗口，请使用cmd运行该程序。运行方法：
	2.1：Win+R搜索cmd并点击确定
	2.2：将软件（快捷方式也可）拖至cmd窗口中复制其文件路径（当然你也可以手动输入或者右键复制）
	2.3：点击回车运行；随后不要移动鼠标。

4：请确保在输入延迟时间前最小化cmd以外的程序并最大化浏览器。将网页的滚动条滚至最上方。将页面从首页切换至“可供书目”。


5：请清空“定数”输入处的自动填充内容（如有），以免遮挡“报定”按钮。


6：书号（不是条码）请输入在“书号输入处"（或_internal/source/shuru.txt）中，以换行为两个书号的分界。

7：jiaoben.py为此程序的源代码，可以用记事本打开查看内容。如果你部署了Python环境并下载了各种支持库可以直接用Python运行。能帮我优化下程序就最好啦。

8：确保你的f1-f12键能够正常运作，不处在fn状态！测试方法：直接点击这些键，看看是不是在调整亮度等设置。解除方法：fn+esc可开启fnlock状态，此时f1-f12可正常生效。

使用中须知
1：由于exe的特性导致系统通知代码无法生效，软件运行时不要移动鼠标也不要切换窗口，除非其停顿时间远大于你所输入的延迟时间，或者在非cmd运行的情况下窗口从任务栏消失。

2：以txt形式输出的报定结果会保存在_internal/result文件夹里，文件名为“output年-月-日 时：分”，文件名所标注的时间即程序输出该txt文件的时间，也可看作程序结束的时间。如果出现导致程序崩溃的报错则必须使用cmd运行才可查看报错原因，且有可能不会生成该txt文件，故强烈推荐使用cmd运行该程序且应时时确认程序是否在运行。

3：报定成功的记录在前，会显示采配库存是否为零；出现意料外情况的输出在后，程序结束后请人工核实出现了何种情况。
-一般而言，对于未找到书籍的情况，txt只会记录“未找到书籍”并添加下一本书，但cmd上会在此之前额外显示一条“采配库存识别失败，使用默认值0”，这是程序逻辑带来的正常现象；若采配库存识别失败后成功添加了该书，该书的报定记录会显示在意料外情况中。
-出现“发货按钮识别失败或网络中断，将在最后重试”错误后会试图刷新网页并在最后重新尝试添加这些书。
-若出现同一个书号对应两本书，程序一般不会添加并将其加入“意料外情况中”
-若书号输入出有重复的书号，txt会记录最后一次输入该书号时的结果（不会添加多本）。

4：可能出现的错误（可以依此排障）：
-网页标签识别失败后程序会直接停止运行——或者说压根就没开始运行。
-由于零库存在p2p系统里为不显示任何数字，因此当库存识别失败后（即使库存不为零）程序会默认库存为零并继续操作且不会报错。
-如果文字识别失败则可能会导致程序在未找到书籍时不跳过该书而是重试。
-由于识别问题，此处的“GO”（图片已删除）会识别成“60”（且识别成功率比采配库存的“0”高的多的多……）：

因此，如果采配库存识别结果仅有一项60（或6）的时候，程序会缩小识别区域并再次尝试识别，这需要额外的时间。
-“发货不补”和“报定”按钮的有无是识别网络是否中断的指标，任意一个识别失败就会中断程序。
-极端情况下，若出现同一个书号对应多名字很长（超过三行）的书时，由于识别区域的限制，程序只会识别到第一本书并将其添加。
-极端情况下，由于识别失误可能使程序未能正确点击搜索或报定按钮。由于现在使用了灰度识别功能故此情况应当非常罕见。
-极端情况下，若书号输入处有重复书号，且第一次报定成功而第二次出现了网络中断，则txt中只会记录该书网络中断且添加失败。不过此错误不影响程序运行，因为程序不会添加多本书。